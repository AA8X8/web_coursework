<!DOCTYPE html>
<html lang="ru" xmlns:th="http://www.thymeleaf.org"
      xmlns:sec="http://www.thymeleaf.org/extras/spring-security">
<head th:replace="fragments/head :: head">
  <title th:text="${restaurant.name} + ' - –°—Ç–æ–ª–∏–∫–û–Ω–ª–∞–π–Ω'"></title>
</head>
<body>
<div th:replace="fragments/navbar :: navbar"></div>

<main class="container">
  <!-- –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Ä–µ—Å—Ç–æ—Ä–∞–Ω–µ -->
  <article class="card">
    <div class="grid">
      <div>
        <img th:src="${restaurant.photoUrl ?: '/pic/restaurant-default.jpg'}"
             alt="–†–µ—Å—Ç–æ—Ä–∞–Ω"
             style="width: 100%; border-radius: 0.5rem;"
             onerror="this.src='/pic/restaurant-default.jpg'">
      </div>
      <div>
        <div style="display: flex; justify-content: space-between; align-items: start;">
          <h2 th:text="${restaurant.name}"></h2>
          <div>
            <span class="rating-stars" th:text="${restaurant.rating} + '‚≠ê'"></span>
            <span th:if="${restaurant.priceLevel == 1}" class="cuisine-badge">üí∞</span>
            <span th:if="${restaurant.priceLevel == 2}" class="cuisine-badge">üí∞üí∞</span>
            <span th:if="${restaurant.priceLevel == 3}" class="cuisine-badge">üí∞üí∞üí∞</span>
          </div>
        </div>

        <p><strong>–¢–∏–ø –∫—É—Ö–Ω–∏:</strong> <span class="cuisine-badge" th:text="${restaurant.cuisine}"></span></p>
        <p><strong>–ê–¥—Ä–µ—Å:</strong> <span th:text="${restaurant.address}"></span></p>
        <p><strong>–¢–µ–ª–µ—Ñ–æ–Ω:</strong> <span th:text="${restaurant.phone}"></span></p>
        <p><strong>Email:</strong> <span th:text="${restaurant.email}"></span></p>
        <p><strong>–ß–∞—Å—ã —Ä–∞–±–æ—Ç—ã:</strong>
          <span th:text="${restaurant.openingTime} + ' - ' + ${restaurant.closingTime}"></span>
        </p>
        <p><strong>–í–º–µ—Å—Ç–∏–º–æ—Å—Ç—å:</strong> <span th:text="${restaurant.maxCapacity} + ' —á–µ–ª–æ–≤–µ–∫'"></span></p>

        <div style="margin-top: 1.5rem;">
          <h3>–û–ø–∏—Å–∞–Ω–∏–µ</h3>
          <p th:text="${restaurant.description}"></p>
        </div>

        <div style="margin-top: 2rem; display: flex; gap: 1rem;">
          <!-- –ò–°–ü–†–ê–í–õ–ï–ù–û: –∏—Å–ø–æ–ª—å–∑—É–µ–º restaurantName –≤–º–µ—Å—Ç–æ restaurantId -->
          <a th:href="@{/bookings/add(restaurantName=${restaurant.name})}"
             role="button"
             class="contrast"
             style="flex: 1; text-align: center;">
            üçΩÔ∏è –ó–∞–±—Ä–æ–Ω–∏—Ä–æ–≤–∞—Ç—å —Å—Ç–æ–ª–∏–∫
          </a>

          <div sec:authorize="hasRole('ADMIN')" style="flex: 1;">
            <!-- –ò–°–ü–†–ê–í–õ–ï–ù–û: –∏—Å–ø–æ–ª—å–∑—É–µ–º name –≤–º–µ—Å—Ç–æ id -->
            <a th:href="@{/restaurants/delete/{name}(name=${restaurant.name})}"
               role="button"
               class="secondary"
               onclick="return confirm('–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ —É–¥–∞–ª–∏—Ç—å —ç—Ç–æ—Ç —Ä–µ—Å—Ç–æ—Ä–∞–Ω?')"
               style="display: block; text-align: center;">
              –£–¥–∞–ª–∏—Ç—å —Ä–µ—Å—Ç–æ—Ä–∞–Ω
            </a>
          </div>
        </div>
      </div>
    </div>
  </article>

  <!-- –û—Ç–∑—ã–≤—ã -->
  <section style="margin-top: 3rem;">
    <hgroup>
      <h2>–û—Ç–∑—ã–≤—ã –∏ —Ä–µ–π—Ç–∏–Ω–≥–∏</h2>
      <p>–ß—Ç–æ –≥–æ–≤–æ—Ä—è—Ç –ø–æ—Å–µ—Ç–∏—Ç–µ–ª–∏</p>
    </hgroup>

    <div th:if="${reviews != null and !reviews.empty}">
      <div class="grid">
        <article th:each="review : ${reviews}" class="card">
          <div style="display: flex; justify-content: space-between; align-items: start;">
            <div>
              <strong th:text="${review.userName}"></strong>
              <div class="rating-stars">
                <span th:each="i : ${#numbers.sequence(1, 5)}">
                  <span th:if="${i <= review.rating}">‚≠ê</span>
                  <span th:if="${i > review.rating}">‚òÜ</span>
                </span>
              </div>
            </div>
            <small th:text="${#temporals.format(review.createdAt, 'dd.MM.yyyy')}"></small>
          </div>
          <p style="margin-top: 1rem;" th:text="${review.content}"></p>
        </article>
      </div>
    </div>

    <div th:if="${reviews == null or reviews.empty}" class="text-center card">
      <p>–ü–æ–∫–∞ –Ω–µ—Ç –æ—Ç–∑—ã–≤–æ–≤. –ë—É–¥—å—Ç–µ –ø–µ—Ä–≤—ã–º!</p>
    </div>
  </section>

  <!-- –§–æ—Ä–º–∞ –¥–ª—è –æ—Ç–∑—ã–≤–∞ (–∫–æ–º–º–µ–Ω—Ç–∏—Ä—É–µ–º, —Ç–∞–∫ –∫–∞–∫ –Ω–µ—Ç –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä–∞ –¥–ª—è –æ—Ç–∑—ã–≤–æ–≤) -->
  <!--
  <article sec:authorize="isAuthenticated()" class="card" style="margin-top: 2rem;">
    <h3>–û—Å—Ç–∞–≤–∏—Ç—å –æ—Ç–∑—ã–≤</h3>
    <form th:action="@{/reviews/add}" method="post">
      <input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}" />
      <input type="hidden" name="restaurantId" th:value="${restaurant.id}">

      <label>
        –í–∞—à–∞ –æ—Ü–µ–Ω–∫–∞ (1-5)
        <select name="rating" required>
          <option value="5">5 ‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê</option>
          <option value="4">4 ‚≠ê‚≠ê‚≠ê‚≠ê</option>
          <option value="3">3 ‚≠ê‚≠ê‚≠ê</option>
          <option value="2">2 ‚≠ê‚≠ê</option>
          <option value="1">1 ‚≠ê</option>
        </select>
      </label>

      <label>
        –í–∞—à –æ—Ç–∑—ã–≤
        <textarea name="content" rows="3" placeholder="–ü–æ–¥–µ–ª–∏—Ç–µ—Å—å –≤–ø–µ—á–∞—Ç–ª–µ–Ω–∏—è–º–∏..." required></textarea>
      </label>

      <button type="submit" class="secondary">–û—Ç–ø—Ä–∞–≤–∏—Ç—å –æ—Ç–∑—ã–≤</button>
    </form>
  </article>
  -->
</main>

<div th:replace="fragments/footer :: footer"></div>

<style>
  /* –û—Å–Ω–æ–≤–Ω—ã–µ —Ü–≤–µ—Ç–∞ —Ç–µ–º–Ω–æ–π —Ç–µ–º—ã */
  :root {
    --dark-bg: #1a1a1a;
    --card-bg: #2d2d2d;
    --card-border: #404040;
    --text-primary: #ffffff;
    --text-secondary: #cccccc;
    --accent-color: #3498db;
    --accent-hover: #2980b9;
    --badge-bg: #3a3a3a;
    --success-bg: #155724;
    --error-bg: #721c24;
  }

  /* –¢–µ–º–Ω—ã–π —Ñ–æ–Ω –¥–ª—è –≤—Å–µ–π —Å—Ç—Ä–∞–Ω–∏—Ü—ã */
  body {
    background-color: var(--dark-bg);
    color: var(--text-primary);
  }

  /* –¢–µ–º–Ω—ã–µ –∫–∞—Ä—Ç–æ—á–∫–∏ —Ä–µ—Å—Ç–æ—Ä–∞–Ω–æ–≤ */
  .card {
    background-color: var(--card-bg);
    border: 1px solid var(--card-border);
    border-radius: 8px;
    padding: 1.5rem;
    transition: transform 0.3s ease, box-shadow 0.3s ease;
    display: flex;
    flex-direction: column;
  }

  .card:hover {
    transform: translateY(-5px);
    box-shadow: 0 10px 25px rgba(0, 0, 0, 0.3);
    border-color: var(--accent-color);
  }

  /* –ó–∞–≥–æ–ª–æ–≤–∫–∏ –≤ –∫–∞—Ä—Ç–æ—á–∫–∞—Ö */
  .card h3 {
    color: var(--text-primary);
    margin-top: 0;
    font-size: 1.4rem;
    border-bottom: 2px solid var(--accent-color);
    padding-bottom: 0.5rem;
    margin-bottom: 1rem;
  }

  /* –¢–µ–∫—Å—Ç –≤ –∫–∞—Ä—Ç–æ—á–∫–∞—Ö */
  .card p {
    color: var(--text-secondary);
    margin: 0.5rem 0;
  }

  /* –ë–µ–π–¥–∂–∏ –∫—É—Ö–Ω–∏ */
  .cuisine-badge {
    background-color: var(--badge-bg);
    color: var(--accent-color);
    padding: 0.3rem 0.8rem;
    border-radius: 20px;
    font-weight: bold;
    font-size: 0.9rem;
    border: 1px solid var(--accent-color);
    display: inline-block;
    margin-bottom: 0.5rem;
  }

  /* –ó–≤–µ–∑–¥—ã —Ä–µ–π—Ç–∏–Ω–≥–∞ */
  .rating-stars {
    color: #ffd700; /* –ó–æ–ª–æ—Ç–æ–π —Ü–≤–µ—Ç –¥–ª—è –∑–≤–µ–∑–¥ */
    font-weight: bold;
    font-size: 1.1rem;
  }

  /* –ö–Ω–æ–ø–∫–∏ –≤ –∫–∞—Ä—Ç–æ—á–∫–∞—Ö - –ò–°–ü–†–ê–í–õ–ï–ù–û (—É–º–µ–Ω—å—à–µ–Ω —Ä–∞–∑–º–µ—Ä) */
  .card-buttons {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 0.5rem;
    width: 100%;
    margin-top: 1.5rem;
  }

  .card-buttons a {
    text-align: center;
    padding: 0.5rem 0.3rem; /* –£–º–µ–Ω—å—à–µ–Ω padding */
    border-radius: 6px;
    text-decoration: none;
    transition: all 0.3s ease;
    font-weight: bold;
    font-size: 0.9rem; /* –£–º–µ–Ω—å—à–µ–Ω —Ä–∞–∑–º–µ—Ä —à—Ä–∏—Ñ—Ç–∞ */
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
  }

  .card-buttons .secondary {
    background-color: #555;
    color: white;
    border: 1px solid #666;
  }

  .card-buttons .secondary:hover {
    background-color: #666;
    border-color: var(--accent-color);
    color: var(--accent-color);
  }

  .card-buttons .contrast {
    background-color: var(--accent-color);
    color: white;
    border: none;
  }

  .card-buttons .contrast:hover {
    background-color: var(--accent-hover);
    transform: scale(1.05);
  }

  /* –û–±—â–∏–µ —Å—Ç–∏–ª–∏ –¥–ª—è –∫–Ω–æ–ø–æ–∫ */
  .secondary {
    background-color: #555;
    color: white;
    border: 1px solid #666;
    padding: 0.7rem 1rem;
    border-radius: 6px;
    text-decoration: none;
    transition: all 0.3s ease;
    display: inline-block;
    text-align: center;
    font-weight: bold;
  }

  .secondary:hover {
    background-color: #666;
    border-color: var(--accent-color);
    color: var(--accent-color);
  }

  .contrast {
    background-color: var(--accent-color);
    color: white;
    border: none;
    padding: 0.7rem 1rem;
    border-radius: 6px;
    text-decoration: none;
    transition: all 0.3s ease;
    display: inline-block;
    text-align: center;
    font-weight: bold;
  }

  .contrast:hover {
    background-color: var(--accent-hover);
    transform: scale(1.05);
  }

  /* –°–æ–æ–±—â–µ–Ω–∏—è */
  .success-message {
    background-color: var(--success-bg);
    color: #d4edda;
    padding: 1rem;
    border-radius: 6px;
    border-left: 4px solid #28a745;
    margin-bottom: 1rem;
  }

  .error-message {
    background-color: var(--error-bg);
    color: #f8d7da;
    padding: 1rem;
    border-radius: 6px;
    border-left: 4px solid #dc3545;
    margin-bottom: 1rem;
  }

  /* –ü–∞–≥–∏–Ω–∞—Ü–∏—è */
  nav ul li a.outline {
    background-color: transparent;
    color: var(--accent-color);
    border: 2px solid var(--accent-color);
    padding: 0.5rem 1rem;
    border-radius: 6px;
  }

  nav ul li a.outline:hover {
    background-color: var(--accent-color);
    color: white;
  }

  /* –ü–æ–∏—Å–∫ –∏ —Ñ–∏–ª—å—Ç—Ä—ã */
  input, select, button[type="submit"] {
    background-color: var(--card-bg);
    color: var(--text-primary);
    border: 1px solid var(--card-border);
    border-radius: 6px;
    padding: 0.7rem;
  }

  input::placeholder {
    color: #888;
  }

  input:focus, select:focus {
    border-color: var(--accent-color);
    outline: none;
    box-shadow: 0 0 0 3px rgba(52, 152, 219, 0.2);
  }

  /* –ó–∞–≥–æ–ª–æ–≤–æ–∫ —Å—Ç—Ä–∞–Ω–∏—Ü—ã */
  h1 {
    color: var(--text-primary);
    text-align: center;
    margin-bottom: 0.5rem;
  }

  hgroup p {
    color: var(--text-secondary);
    text-align: center;
    margin-bottom: 2rem;
    font-size: 1.1rem;
  }

  /* –ö–æ–≥–¥–∞ –Ω–µ—Ç —Ä–µ—Å—Ç–æ—Ä–∞–Ω–æ–≤ */
  .text-center.card {
    background-color: var(--card-bg);
    border: 2px dashed var(--card-border);
    padding: 2rem;
  }

  .text-center.card h3 {
    color: var(--text-primary);
  }

  .text-center.card p {
    color: var(--text-secondary);
  }

  /* –°–µ—Ç–∫–∞ –≥—Ä–∏–¥–∞ */
  .grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(320px, 1fr));
    gap: 2rem;
    margin-bottom: 2rem;
  }

  /* –ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è —Ä–µ—Å—Ç–æ—Ä–∞–Ω–æ–≤ */
  .restaurant-image {
    width: 100%;
    height: 200px;
    object-fit: cover;
    border-radius: 6px;
    border: 2px solid var(--card-border);
    transition: transform 0.3s ease, border-color 0.3s ease;
  }

  .restaurant-image:hover {
    border-color: var(--accent-color);
    transform: scale(1.02);
  }

  /* –¶–µ–Ω–æ–≤–æ–π —É—Ä–æ–≤–µ–Ω—å */
  p strong {
    color: var(--text-primary);
    margin-right: 0.5rem;
  }

  /* –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä */
  .container {
    max-width: 1200px;
    margin: 0 auto;
    padding: 2rem;
  }

  /* –ê–¥–∞–ø—Ç–∏–≤–Ω–æ—Å—Ç—å –¥–ª—è –º–æ–±–∏–ª—å–Ω—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤ */
  @media (max-width: 768px) {
    .grid {
      grid-template-columns: 1fr;
      gap: 1.5rem;
    }

    .card-buttons {
      grid-template-columns: 1fr;
      gap: 0.5rem;
    }

    .card-buttons a {
      padding: 0.6rem 0.4rem;
      font-size: 0.9rem;
    }

    .container {
      padding: 1rem;
    }
  }

  @media (max-width: 480px) {
    .card-buttons a {
      font-size: 0.85rem;
      padding: 0.5rem 0.3rem;
    }

    .card h3 {
      font-size: 1.2rem;
    }

    .grid {
      grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
    }
  }

  @media (max-width: 360px) {
    .card-buttons a {
      font-size: 0.8rem;
      padding: 0.4rem 0.2rem;
    }

    .cuisine-badge {
      font-size: 0.8rem;
      padding: 0.2rem 0.6rem;
    }

    .grid {
      grid-template-columns: 1fr;
    }

    .card {
      padding: 1rem;
    }
  }
</style>

</body>
</html>